import{J as Q,O as E,w as B,ak as Z,U as R,j as w,i as c,F as K,V as j,R as h,P as H,Q as T,l as _,K as u,n as W,L as b,C as x,M as n,N as $,a2 as P,al as Y,a3 as ee,am as J,T as k,S as te}from"./index-CeL4bcLB.js";import{N as se,V as M,_ as ae,w as z,G as F,F as G,x as V,A as X,z as N,O as re,y as ne,B as oe,C as le}from"./_plugin-vue_export-helper-l3zcP0kf.js";import{V as O}from"./VAlert-2CFT-IG1.js";import{V as ce}from"./VSpacer-CeufIaEN.js";const ue={class:"progress-path"},ie={class:"progress-path__track"},de=["aria-current","aria-label","data-testid"],fe={key:1,class:"text-caption font-weight-bold"},pe=Q({__name:"ProgressPath",props:{total:{},current:{}},setup(t){const a=t,s=h(null);let v;async function e(){await H();const l=await T();if(!l||!s.value)return;v?.kill();const m=s.value.querySelectorAll(".progress-path__node")[a.current];m&&(v=l.to(m,{scale:1.15,repeat:-1,yoyo:!0,duration:.6,ease:"sine.inOut"}))}E(e),B(()=>a.current,e),Z(()=>{v?.kill()});const p=_(()=>a.total>0?Math.round(a.current/a.total*100):0);function i(l){return{"bg-primary":l<a.current,"bg-secondary":l===a.current,"progress-path__node--completed":l<a.current,"progress-path__node--current":l===a.current,"progress-path__node--upcoming":l>a.current}}return(l,f)=>(u(),R("div",ue,[w("div",ie,[c(se,{"aria-label":"Quiz progress","bg-color":"surface",class:"progress-path__line",color:"secondary",height:"6","model-value":p.value,rounded:""},null,8,["model-value"])]),w("div",{ref_key:"nodesRef",ref:s,class:"progress-path__nodes",role:"list"},[(u(!0),R(K,null,j(t.total,(m,g)=>(u(),R("div",{key:g,"aria-current":g===t.current?"step":void 0,"aria-label":`Question ${g+1} of ${t.total}`,class:W(["progress-path__node",i(g)]),"data-testid":`step-node-${g}`,role:"listitem"},[g<t.current?(u(),b(M,{key:0,icon:"mdi-check",size:"16"})):(u(),R("span",fe,x(g+1),1))],10,de))),128))],512)]))}}),ve=ae(pe,[["__scopeId","data-v-22581e96"]]);function me(t){const a=h(0),s=h(null),v=h(0),e=_(()=>t.questions[a.value]),p=_(()=>t.questions.length),i=_(()=>a.value>=t.questions.length),l=_(()=>t.questions.length>0?a.value/t.questions.length*100:0);function f(r){s.value=r}function m(){const o=e.value.answers.find(C=>C.isCorrect),d=s.value===o?.id;return d&&v.value++,s.value=null,{correct:d,correctAnswerId:o?.id??""}}function g(){a.value<t.questions.length&&a.value++}function A(){a.value=0,s.value=null,v.value=0}return{currentIndex:a,currentQuestion:e,progress:l,score:_(()=>v.value),totalQuestions:p,isComplete:i,selectAnswer:f,submitAnswer:m,nextQuestion:g,reset:A}}const ge={class:"text-body-1"},be=Q({__name:"QuestionStep",props:{question:{},feedbackResult:{},selectedAnswerId:{}},emits:["answer","next"],setup(t,{emit:a}){const s=t,v=a,e=h(null),p=h(null);function i(r){s.feedbackResult||(e.value=r)}function l(){e.value&&v("answer",e.value)}function f(r){return s.feedbackResult?{"bg-success":r===s.feedbackResult.correctAnswerId,"bg-error":!s.feedbackResult.correct&&r===s.selectedAnswerId&&r!==s.feedbackResult.correctAnswerId}:{"bg-primary":e.value===r}}async function m(){await H();const r=await T();if(!r||!p.value)return;const o=p.value.querySelectorAll(".answer-option");o.length!==0&&r.from(o,{scale:0,opacity:0,stagger:.08,duration:.4,ease:"back.out(1.4)"})}E(m),B(()=>s.question.id,m),B(()=>s.feedbackResult,async r=>{if(!r)return;const o=await T();if(!o||!p.value)return;const d=s.question.answers.findIndex(q=>q.id===s.selectedAnswerId),y=p.value.querySelectorAll(".answer-option")[d];y&&(r.correct?(o.fromTo(y,{scale:1},{scale:1.08,yoyo:!0,repeat:2,duration:.15,ease:"power1.inOut"}),g(o,y)):o.fromTo(y,{x:0},{x:10,yoyo:!0,repeat:4,duration:.08,ease:"power1.inOut"}))});function g(r,o){const d=o.getBoundingClientRect(),C=d.left+d.width/2,y=d.top+d.height/2,q=getComputedStyle(document.documentElement),L=[`rgb(${q.getPropertyValue("--v-theme-secondary")})`,`rgb(${q.getPropertyValue("--v-theme-primary")})`,`rgb(${q.getPropertyValue("--v-theme-success")})`,`rgb(${q.getPropertyValue("--v-theme-error")})`,`rgb(${q.getPropertyValue("--v-theme-info")})`,`rgb(${q.getPropertyValue("--v-theme-warning")})`];for(let I=0;I<12;I++){const S=document.createElement("div");Object.assign(S.style,{position:"fixed",left:`${C}px`,top:`${y}px`,width:"8px",height:"8px",borderRadius:"50%",backgroundColor:L[I%L.length],zIndex:"9999",pointerEvents:"none"}),document.body.append(S);const U=Math.PI*2*I/12,D=60+Math.random()*40;r.to(S,{x:Math.cos(U)*D,y:Math.sin(U)*D,opacity:0,duration:.6,ease:"power2.out",onComplete:()=>S.remove()})}}function A(r){return s.feedbackResult&&(r===s.feedbackResult.correctAnswerId||r===s.selectedAnswerId)||e.value===r?"flat":"outlined"}return(r,o)=>(u(),b(z,{class:"question-step pa-6",elevation:"2"},{default:n(()=>[c(F,{class:"pb-2"},{default:n(()=>[c(G,{class:"text-h6 font-weight-bold"},{default:n(()=>[$(x(t.question.text),1)]),_:1})]),_:1}),c(V,{class:"px-6 pt-4 pb-2"},{default:n(()=>[w("div",{ref_key:"answersRef",ref:p},[(u(!0),R(K,null,j(t.question.answers,(d,C)=>(u(),b(z,{key:d.id,"aria-label":d.text,"aria-selected":e.value===d.id,class:W(["mb-3 answer-option",f(d.id)]),"data-testid":`answer-option-${C}`,disabled:!!t.feedbackResult,role:"button",rounded:"lg",tabindex:t.feedbackResult?-1:0,variant:A(d.id),onClick:y=>i(d.id),onKeydown:[Y(y=>i(d.id),["enter"]),Y(ee(y=>i(d.id),["prevent"]),["space"])]},{default:n(()=>[c(V,{class:"d-flex align-center"},{default:n(()=>[w("span",ge,x(d.text),1)]),_:2},1024)]),_:2},1032,["aria-label","aria-selected","class","data-testid","disabled","tabindex","variant","onClick","onKeydown"]))),128))],512),t.feedbackResult?.correct?(u(),b(O,{key:0,"aria-live":"polite",class:"mt-4","data-testid":"feedback-correct",density:"compact",type:"success",variant:"tonal"},{default:n(()=>[...o[1]||(o[1]=[$(" Correct! ",-1)])]),_:1})):P("",!0),t.feedbackResult&&!t.feedbackResult.correct?(u(),b(O,{key:1,"aria-live":"polite",class:"mt-4","data-testid":"feedback-incorrect",density:"compact",type:"error",variant:"tonal"},{default:n(()=>[...o[2]||(o[2]=[$(" Incorrect ",-1)])]),_:1})):P("",!0)]),_:1}),c(X,{class:"px-6 pb-6"},{default:n(()=>[c(ce),t.feedbackResult?P("",!0):(u(),b(N,{key:0,color:"secondary","data-testid":"confirm-btn",disabled:!e.value,variant:"flat",onClick:l},{default:n(()=>[...o[3]||(o[3]=[$(" Confirm ",-1)])]),_:1},8,["disabled"])),t.feedbackResult?(u(),b(N,{key:1,color:"primary","data-testid":"next-btn",variant:"flat",onClick:o[0]||(o[0]=d=>r.$emit("next"))},{default:n(()=>[...o[4]||(o[4]=[$(" Next ",-1)])]),_:1})):P("",!0)]),_:1})]),_:1}))}}),ye={class:"text-h5 font-weight-bold"},xe={class:"text-h6 mt-4"},we={class:"font-weight-bold"},he={key:0,class:"text-caption"},ke=Q({__name:"ScoreScreen",props:{score:{},total:{},results:{}},emits:["restart"],setup(t){const a=t,s=_(()=>a.total>0?Math.round(a.score/a.total*100):0),v=h(J.value?0:a.score),e=h(J.value?0:s.value);E(async()=>{const l=await T();if(!l){v.value=a.score,e.value=s.value;return}const f={s:0,p:0};l.to(f,{s:a.score,p:s.value,duration:1.2,ease:"power2.out",onUpdate:()=>{v.value=Math.round(f.s),e.value=Math.round(f.p)}})});const p=_(()=>s.value>=70),i=_(()=>p.value?"success":"warning");return(l,f)=>(u(),b(z,{class:"score-screen text-center",elevation:"2"},{default:n(()=>[c(F,null,{default:n(()=>[c(G,{class:"text-h5 font-weight-bold"},{default:n(()=>[...f[1]||(f[1]=[$(" Your Score ",-1)])]),_:1})]),_:1}),c(V,null,{default:n(()=>[c(re,{"aria-label":`Score: ${e.value} percent`,color:i.value,"data-testid":"score-progress","model-value":e.value,role:"progressbar",size:120,width:10},{default:n(()=>[w("span",ye,x(e.value)+"%",1)]),_:1},8,["aria-label","color","model-value"]),w("div",xe,x(v.value)+" / "+x(t.total),1),c(O,{class:"mt-4","data-testid":"result-message",density:"compact",type:p.value?"success":"info",variant:"tonal"},{default:n(()=>[$(x(p.value?"Great job!":"Keep practicing!"),1)]),_:1},8,["type"])]),_:1}),c(ne,{class:"mx-4"}),c(V,null,{default:n(()=>[f[2]||(f[2]=w("div",{class:"text-subtitle-1 font-weight-bold text-left mb-2"}," Recap ",-1)),(u(!0),R(K,null,j(t.results,(m,g)=>(u(),b(z,{key:g,class:"mb-2 text-left","data-testid":`recap-item-${g}`,rounded:"lg",variant:"tonal"},{default:n(()=>[c(V,{class:"d-flex align-center ga-3 py-2"},{default:n(()=>[m.correct?(u(),b(M,{key:0,"aria-label":"Correct",color:"success","data-testid":"recap-icon-correct",icon:"mdi-check-circle"})):(u(),b(M,{key:1,"aria-label":"Incorrect",color:"error","data-testid":"recap-icon-incorrect",icon:"mdi-close-circle"})),w("div",null,[w("div",we,x(m.questionText),1),m.correct?P("",!0):(u(),R("div",he," Your answer: "+x(m.selectedAnswerText)+" â€” Correct: "+x(m.correctAnswerText),1))])]),_:2},1024)]),_:2},1032,["data-testid"]))),128))]),_:1}),c(X,{class:"justify-center pb-4"},{default:n(()=>[c(N,{color:"secondary","data-testid":"play-again-btn","prepend-icon":"mdi-replay",size:"large",variant:"flat",onClick:f[0]||(f[0]=m=>l.$emit("restart"))},{default:n(()=>[...f[3]||(f[3]=[$(" Play again ",-1)])]),_:1})]),_:1})]),_:1}))}}),_e={class:"text-subtitle-1 text-center mt-2 mb-4"},Ce=Q({__name:"QuizPlayer",props:{quiz:{}},emits:["restart"],setup(t,{emit:a}){const s=t,v=a,e=me(s.quiz),p=h(null),i=h(null),l=h([]);function f(A){i.value=A,e.selectAnswer(A);const r=e.currentQuestion.value,o=r.answers.find(y=>y.id===A),d=r.answers.find(y=>y.isCorrect),C=e.submitAnswer();p.value=C,l.value.push({questionText:r.text,correct:C.correct,selectedAnswerText:o?.text??"",correctAnswerText:d?.text??""})}function m(){p.value=null,i.value=null,e.nextQuestion()}function g(){p.value=null,i.value=null,l.value=[],e.reset(),v("restart")}return(A,r)=>(u(),b(z,{class:"quiz-player pa-6","data-testid":"quiz-player-card",elevation:"2"},{default:n(()=>[c(F,null,{default:n(()=>[c(G,{class:"text-h5 font-weight-bold"},{default:n(()=>[$(x(t.quiz.title),1)]),_:1})]),_:1}),k(e).isComplete.value?(u(),b(V,{key:1},{default:n(()=>[c(ke,{"data-testid":"score-screen",results:l.value,score:k(e).score.value,total:k(e).totalQuestions.value,onRestart:g},null,8,["results","score","total"])]),_:1})):(u(),b(V,{key:0},{default:n(()=>[c(ve,{current:k(e).currentIndex.value,"data-testid":"progress-path",total:k(e).totalQuestions.value},null,8,["current","total"]),w("div",_e,x(k(e).currentIndex.value+1)+" / "+x(k(e).totalQuestions.value),1),c(be,{"data-testid":"question-step","feedback-result":p.value??void 0,question:k(e).currentQuestion.value,"selected-answer-id":i.value??void 0,onAnswer:f,onNext:m},null,8,["feedback-result","question","selected-answer-id"])]),_:1}))]),_:1}))}}),$e={class:"d-flex align-center ga-2 mb-6"},Ae={key:0,class:"text-center py-12"},ze=Q({__name:"QuizPlayerView",props:{id:{}},setup(t){const a=t,s=te(),v=oe(),e=_(()=>v.getQuizById(a.id));return(p,i)=>(u(),b(le,null,{default:n(()=>[w("div",$e,[c(N,{"aria-label":"Back to quiz list","data-testid":"back-btn",icon:"mdi-arrow-left",variant:"text",onClick:i[0]||(i[0]=l=>k(s).push({name:"quiz-list"}))}),i[2]||(i[2]=w("h1",{class:"text-h4 font-weight-bold"},"Quiz Player",-1))]),e.value?(u(),b(Ce,{key:1,quiz:e.value,onRestart:i[1]||(i[1]=l=>k(s).push({name:"quiz-list"}))},null,8,["quiz"])):(u(),R("div",Ae,[c(M,{class:"mb-4",color:"warning",icon:"mdi-alert-circle-outline",size:"64"}),i[3]||(i[3]=w("div",{class:"text-h6"},"Quiz not found",-1))]))]),_:1}))}});export{ze as default};
