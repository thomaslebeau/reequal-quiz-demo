import{J as Q,O as E,w as B,ak as Z,U as A,j as x,i as u,F as K,V as j,R as _,P as H,Q as T,l as k,K as i,n as W,L as b,C as y,M as o,N as $,a2 as P,al as Y,a3 as ee,am as J,T as C,S as te}from"./index-DL46mXrj.js";import{N as se,V as M,_ as ae,w as z,G as F,F as G,x as R,A as X,z as N,O as re,y as ne,B as oe,C as le}from"./_plugin-vue_export-helper-gg6-hRDx.js";import{V as O}from"./VAlert-BA30lzic.js";import{V as ce}from"./VSpacer-jCo8Qir_.js";const ue={class:"progress-path"},ie={class:"progress-path__track"},de=["aria-current","aria-label","data-testid"],fe={key:1,class:"text-caption font-weight-bold"},pe=Q({__name:"ProgressPath",props:{total:{},current:{}},setup(t){const s=t,r=_(null);let p;async function e(){await H();const l=await T();if(!l||!r.value)return;p?.kill();const v=r.value.querySelectorAll(".progress-path__node")[s.current];v&&(p=l.to(v,{scale:1.15,repeat:-1,yoyo:!0,duration:.6,ease:"sine.inOut"}))}E(e),B(()=>s.current,e),Z(()=>{p?.kill()});const m=k(()=>s.total>0?Math.round(s.current/s.total*100):0);function d(l){return{"bg-primary":l<s.current,"bg-secondary":l===s.current,"progress-path__node--completed":l<s.current,"progress-path__node--current":l===s.current,"progress-path__node--upcoming":l>s.current}}return(l,f)=>(i(),A("div",ue,[x("div",ie,[u(se,{"aria-label":"Quiz progress","bg-color":"surface",class:"progress-path__line",color:"secondary",height:"6","model-value":m.value,rounded:""},null,8,["model-value"])]),x("div",{ref_key:"nodesRef",ref:r,class:"progress-path__nodes",role:"list"},[(i(!0),A(K,null,j(t.total,(v,g)=>(i(),A("div",{key:g,"aria-current":g===t.current?"step":void 0,"aria-label":`Question ${g+1} of ${t.total}`,class:W(["progress-path__node",d(g)]),"data-testid":`step-node-${g}`,role:"listitem"},[g<t.current?(i(),b(M,{key:0,icon:"mdi-check",size:"16"})):(i(),A("span",fe,y(g+1),1))],10,de))),128))],512)]))}}),ve=ae(pe,[["__scopeId","data-v-22581e96"]]);function me(t){const s=_(0),r=_(null),p=_(0),e=k(()=>t.questions[s.value]),m=k(()=>t.questions.length),d=k(()=>s.value>=t.questions.length),l=k(()=>t.questions.length>0?s.value/t.questions.length*100:0);function f(a){r.value=a}function v(){const n=e.value.answers.find(q=>q.isCorrect),c=r.value===n?.id;return c&&p.value++,r.value=null,{correct:c,correctAnswerId:n?.id??""}}function g(){s.value<t.questions.length&&s.value++}function V(){s.value=0,r.value=null,p.value=0}return{currentIndex:s,currentQuestion:e,progress:l,score:k(()=>p.value),totalQuestions:m,isComplete:d,selectAnswer:f,submitAnswer:v,nextQuestion:g,reset:V}}const ge={class:"text-body-1"},be=Q({__name:"QuestionStep",props:{question:{},feedbackResult:{},selectedAnswerId:{}},emits:["answer","next"],setup(t,{emit:s}){const r=t,p=s,e=_(null),m=_(null);function d(a){r.feedbackResult||(e.value=a)}function l(){e.value&&p("answer",e.value)}function f(a){return r.feedbackResult?{"bg-success":a===r.feedbackResult.correctAnswerId,"bg-error":!r.feedbackResult.correct&&a===r.selectedAnswerId&&a!==r.feedbackResult.correctAnswerId}:{"bg-primary":e.value===a}}async function v(){await H();const a=await T();if(!a||!m.value)return;const n=m.value.querySelectorAll(".answer-option");n.length!==0&&a.from(n,{scale:0,opacity:0,stagger:.08,duration:.4,ease:"back.out(1.4)",clearProps:"all"})}E(v),B(()=>r.question.id,v),B(()=>r.feedbackResult,async a=>{if(!a)return;const n=await T();if(!n||!m.value)return;const c=r.question.answers.findIndex(h=>h.id===r.selectedAnswerId),w=m.value.querySelectorAll(".answer-option")[c];w&&(a.correct?(n.fromTo(w,{scale:1},{scale:1.08,yoyo:!0,repeat:2,duration:.15,ease:"power1.inOut"}),g(n,w)):n.fromTo(w,{x:0},{x:10,yoyo:!0,repeat:4,duration:.08,ease:"power1.inOut"}))});function g(a,n){const c=n.getBoundingClientRect(),q=c.left+c.width/2,w=c.top+c.height/2,h=getComputedStyle(document.documentElement),L=[`rgb(${h.getPropertyValue("--v-theme-secondary")})`,`rgb(${h.getPropertyValue("--v-theme-primary")})`,`rgb(${h.getPropertyValue("--v-theme-success")})`,`rgb(${h.getPropertyValue("--v-theme-error")})`,`rgb(${h.getPropertyValue("--v-theme-info")})`,`rgb(${h.getPropertyValue("--v-theme-warning")})`];for(let I=0;I<12;I++){const S=document.createElement("div");Object.assign(S.style,{position:"fixed",left:`${q}px`,top:`${w}px`,width:"8px",height:"8px",borderRadius:"50%",backgroundColor:L[I%L.length],zIndex:"9999",pointerEvents:"none"}),document.body.append(S);const U=Math.PI*2*I/12,D=60+Math.random()*40;a.to(S,{x:Math.cos(U)*D,y:Math.sin(U)*D,opacity:0,duration:.6,ease:"power2.out",onComplete:()=>S.remove()})}}function V(a){return r.feedbackResult||e.value===a?"flat":"outlined"}return(a,n)=>(i(),b(z,{class:"question-step pa-6",elevation:"2"},{default:o(()=>[u(F,{class:"pb-2"},{default:o(()=>[u(G,{class:"text-h6 font-weight-bold"},{default:o(()=>[$(y(t.question.text),1)]),_:1})]),_:1}),u(R,{class:"px-6 pt-4 pb-2"},{default:o(()=>[x("div",{ref_key:"answersRef",ref:m},[(i(!0),A(K,null,j(t.question.answers,(c,q)=>(i(),b(z,{key:c.id,"aria-label":c.text,"aria-selected":e.value===c.id,class:W(["mb-3 answer-option",f(c.id)]),"data-testid":`answer-option-${q}`,disabled:!!t.feedbackResult,role:"button",rounded:"lg",tabindex:t.feedbackResult?-1:0,variant:V(c.id),onClick:w=>d(c.id),onKeydown:[Y(w=>d(c.id),["enter"]),Y(ee(w=>d(c.id),["prevent"]),["space"])]},{default:o(()=>[u(R,{class:"d-flex align-center"},{default:o(()=>[x("span",ge,y(c.text),1)]),_:2},1024)]),_:2},1032,["aria-label","aria-selected","class","data-testid","disabled","tabindex","variant","onClick","onKeydown"]))),128))],512),t.feedbackResult?.correct?(i(),b(O,{key:0,"aria-live":"polite",class:"mt-4","data-testid":"feedback-correct",density:"compact",type:"success",variant:"tonal"},{default:o(()=>[...n[1]||(n[1]=[$(" Correct! ",-1)])]),_:1})):P("",!0),t.feedbackResult&&!t.feedbackResult.correct?(i(),b(O,{key:1,"aria-live":"polite",class:"mt-4","data-testid":"feedback-incorrect",density:"compact",type:"error",variant:"tonal"},{default:o(()=>[...n[2]||(n[2]=[$(" Incorrect ",-1)])]),_:1})):P("",!0)]),_:1}),u(X,{class:"px-6 pb-6"},{default:o(()=>[u(ce),t.feedbackResult?P("",!0):(i(),b(N,{key:0,color:"secondary","data-testid":"confirm-btn",disabled:!e.value,variant:"flat",onClick:l},{default:o(()=>[...n[3]||(n[3]=[$(" Confirm ",-1)])]),_:1},8,["disabled"])),t.feedbackResult?(i(),b(N,{key:1,color:"primary","data-testid":"next-btn",variant:"flat",onClick:n[0]||(n[0]=c=>a.$emit("next"))},{default:o(()=>[...n[4]||(n[4]=[$(" Next ",-1)])]),_:1})):P("",!0)]),_:1})]),_:1}))}}),ye={class:"text-h5 font-weight-bold"},xe={class:"text-h6 mt-4"},we={class:"font-weight-bold"},he={key:0,class:"text-caption"},ke=Q({__name:"ScoreScreen",props:{score:{},total:{},results:{}},emits:["restart"],setup(t){const s=t,r=k(()=>s.total>0?Math.round(s.score/s.total*100):0),p=_(J.value?0:s.score),e=_(J.value?0:r.value);E(async()=>{const l=await T();if(!l){p.value=s.score,e.value=r.value;return}const f={s:0,p:0};l.to(f,{s:s.score,p:r.value,duration:1.2,ease:"power2.out",onUpdate:()=>{p.value=Math.round(f.s),e.value=Math.round(f.p)}})});const m=k(()=>r.value>=70),d=k(()=>m.value?"success":"warning");return(l,f)=>(i(),b(z,{class:"score-screen text-center",elevation:"2"},{default:o(()=>[u(F,null,{default:o(()=>[u(G,{class:"text-h5 font-weight-bold"},{default:o(()=>[...f[1]||(f[1]=[$(" Your Score ",-1)])]),_:1})]),_:1}),u(R,null,{default:o(()=>[u(re,{"aria-label":`Score: ${e.value} percent`,color:d.value,"data-testid":"score-progress","model-value":e.value,role:"progressbar",size:120,width:10},{default:o(()=>[x("span",ye,y(e.value)+"%",1)]),_:1},8,["aria-label","color","model-value"]),x("div",xe,y(p.value)+" / "+y(t.total),1),u(O,{class:"mt-4","data-testid":"result-message",density:"compact",type:m.value?"success":"info",variant:"tonal"},{default:o(()=>[$(y(m.value?"Great job!":"Keep practicing!"),1)]),_:1},8,["type"])]),_:1}),u(ne,{class:"mx-4"}),u(R,null,{default:o(()=>[f[2]||(f[2]=x("div",{class:"text-subtitle-1 font-weight-bold text-left mb-2"}," Recap ",-1)),(i(!0),A(K,null,j(t.results,(v,g)=>(i(),b(z,{key:g,class:"mb-2 text-left","data-testid":`recap-item-${g}`,rounded:"lg",variant:"tonal"},{default:o(()=>[u(R,{class:"d-flex align-center ga-3 py-2"},{default:o(()=>[v.correct?(i(),b(M,{key:0,"aria-label":"Correct",color:"success","data-testid":"recap-icon-correct",icon:"mdi-check-circle"})):(i(),b(M,{key:1,"aria-label":"Incorrect",color:"error","data-testid":"recap-icon-incorrect",icon:"mdi-close-circle"})),x("div",null,[x("div",we,y(v.questionText),1),v.correct?P("",!0):(i(),A("div",he," Your answer: "+y(v.selectedAnswerText)+" â€” Correct: "+y(v.correctAnswerText),1))])]),_:2},1024)]),_:2},1032,["data-testid"]))),128))]),_:1}),u(X,{class:"justify-center pb-4"},{default:o(()=>[u(N,{color:"secondary","data-testid":"play-again-btn","prepend-icon":"mdi-replay",size:"large",variant:"flat",onClick:f[0]||(f[0]=v=>l.$emit("restart"))},{default:o(()=>[...f[3]||(f[3]=[$(" Play again ",-1)])]),_:1})]),_:1})]),_:1}))}}),_e={class:"text-subtitle-1 text-center mt-2 mb-4"},Ce=Q({__name:"QuizPlayer",props:{quiz:{}},emits:["restart"],setup(t,{emit:s}){const r=t,p=s,e=me(r.quiz),m=k(()=>{const a=e.currentQuestion.value;if(a)return{id:a.id,text:a.text,answers:a.answers.map(({id:n,text:c})=>({id:n,text:c}))}}),d=_(null),l=_(null),f=_([]);function v(a){l.value=a,e.selectAnswer(a);const n=e.currentQuestion.value,c=n.answers.find(h=>h.id===a),q=n.answers.find(h=>h.isCorrect),w=e.submitAnswer();d.value=w,f.value.push({questionText:n.text,correct:w.correct,selectedAnswerText:c?.text??"",correctAnswerText:q?.text??""})}function g(){d.value=null,l.value=null,e.nextQuestion()}function V(){d.value=null,l.value=null,f.value=[],e.reset(),p("restart")}return(a,n)=>(i(),b(z,{class:"quiz-player pa-6","data-testid":"quiz-player-card",elevation:"2"},{default:o(()=>[u(F,null,{default:o(()=>[u(G,{class:"text-h5 font-weight-bold"},{default:o(()=>[$(y(t.quiz.title),1)]),_:1})]),_:1}),C(e).isComplete.value?(i(),b(R,{key:1},{default:o(()=>[u(ke,{"data-testid":"score-screen",results:f.value,score:C(e).score.value,total:C(e).totalQuestions.value,onRestart:V},null,8,["results","score","total"])]),_:1})):(i(),b(R,{key:0},{default:o(()=>[u(ve,{current:C(e).currentIndex.value,"data-testid":"progress-path",total:C(e).totalQuestions.value},null,8,["current","total"]),x("div",_e,y(C(e).currentIndex.value+1)+" / "+y(C(e).totalQuestions.value),1),u(be,{"data-testid":"question-step","feedback-result":d.value??void 0,question:m.value,"selected-answer-id":l.value??void 0,onAnswer:v,onNext:g},null,8,["feedback-result","question","selected-answer-id"])]),_:1}))]),_:1}))}}),$e={class:"d-flex align-center ga-2 mb-6"},qe={key:0,class:"text-center py-12"},ze=Q({__name:"QuizPlayerView",props:{id:{}},setup(t){const s=t,r=te(),p=oe(),e=k(()=>p.getQuizById(s.id));return(m,d)=>(i(),b(le,null,{default:o(()=>[x("div",$e,[u(N,{"aria-label":"Back to quiz list","data-testid":"back-btn",icon:"mdi-arrow-left",variant:"text",onClick:d[0]||(d[0]=l=>C(r).push({name:"quiz-list"}))}),d[2]||(d[2]=x("h1",{class:"text-h4 font-weight-bold"},"Quiz Player",-1))]),e.value?(i(),b(Ce,{key:1,quiz:e.value,onRestart:d[1]||(d[1]=l=>C(r).push({name:"quiz-list"}))},null,8,["quiz"])):(i(),A("div",qe,[u(M,{class:"mb-4",color:"warning",icon:"mdi-alert-circle-outline",size:"64"}),d[3]||(d[3]=x("div",{class:"text-h6"},"Quiz not found",-1))]))]),_:1}))}});export{ze as default};
